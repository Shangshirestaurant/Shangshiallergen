:root{
  --brand:#C5A163; --brand-dark:#A88849;
  --green:#0E3B2C; --green-2:#1E5A46;
  --bg:#F9F7EF;
  --panel:#FFFFFF;
  --border:#E5DFD3;
  --text:#0B0F14;
  --muted:#4B5563;
  --toolbar:0px;
}
html[data-theme="dark"]{
  --bg:#0B0F14;
  --panel:#11161C;
  --border:#273042;
  --text:#E5E7EB;
  --muted:#A3AAB5;
  --green:#CBE6D9;
  --green-2:#8BCDB8;
}

/* Base */
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;}
.shell{max-width:1200px;margin:0 auto;padding:0 20px}

/* Header */
.nav{
  position: sticky;
  top: 0;
  z-index: 10;
  backdrop-filter: blur(16px) saturate(120%);
  -webkit-backdrop-filter: blur(16px) saturate(120%);
  background: color-mix(in srgb, var(--bg) 70%, transparent);
  border-bottom: 1px solid var(--border);
}
.nav-inner{display:flex;justify-content:space-between;align-items:center;padding:8px 0}
.brand img{
  width:48px; height:48px;
  border-radius:999px;
  border:1px solid var(--border);
  object-fit:cover;
  display:block;
}
.nav-actions{display:flex;gap:8px;align-items:center}
.mini{padding:8px 12px;border-radius:999px;border:1px solid var(--border);background:transparent;color:var(--green);font-weight:700}
.mini.ghost:hover{background:color-mix(in srgb, var(--green) 4%, white 96%)}

/* Hero (no large logo) */
.hero{padding:24px 0;border-bottom:1px solid var(--border);background:radial-gradient(600px 220px at 70% -80px, color-mix(in srgb, var(--brand) 9%, transparent), transparent)}
.hero-grid{display:grid;grid-template-columns:1.2fr .8fr;gap:22px;align-items:center}
@media (max-width:980px){.hero-grid{grid-template-columns:1fr}}
.hero h1{font-family:Georgia,serif;font-size:clamp(28px,4.6vw,48px);margin:0 0 8px;color:var(--green)}
.hero .lead{color:var(--muted);margin:0 0 14px}
.btn{display:inline-block;padding:12px 16px;border-radius:12px;border:1px solid var(--border);text-decoration:none;font-weight:700;transition:transform .2s ease}
.btn.primary{background:linear-gradient(180deg,var(--brand),var(--brand-dark));color:var(--green);border-color:color-mix(in srgb, var(--brand) 60%, black 15%);box-shadow:0 8px 24px color-mix(in srgb, var(--brand) 30%, transparent)}
.btn.primary:hover{transform:translateY(-1px)}
.btn.ghost{background:transparent;color:var(--green);border-color:color-mix(in srgb, var(--green) 25%, var(--border))}
.btn.ghost:hover{background:color-mix(in srgb, var(--green) 4%, white 96%)}

/* Panels & cards */
.section{padding:24px 0}
.main-grid{display:grid;grid-template-columns:1fr;gap:18px}
.panel{background:var(--panel);border:1px solid var(--border);border-radius:18px;padding:16px;box-shadow:0 10px 26px rgba(14,59,44,.06)}
.toolbar{display:flex;gap:10px;align-items:center;margin-bottom:10px}
.toolbar.smallgap{gap:8px;margin-top:6px}
.search{flex:1;padding:12px 14px;border-radius:12px;border:1px solid var(--border);background:var(--panel);color:var(--text)}
.cards{display:grid;gap:12px}
.card{padding:14px;border:1px solid var(--border);border-radius:16px;background:var(--panel);box-shadow:0 6px 18px rgba(14,59,44,.05);opacity:0;transform:translateY(6px);animation:cardIn .25s ease forwards}
@keyframes cardIn{to{opacity:1;transform:none}}
.card h4{color:var(--green);margin:0 0 6px}
.badges{display:flex;gap:6px;flex-wrap:wrap;margin:6px 0 8px}
.badge{
  display:inline-block;
  padding:4px 8px;
  border-radius:999px;
  background: var(--panel);
  border:1px solid var(--border);
  color: var(--text);
  font-family: ui-monospace,Menlo,Consolas,monospace;
  font-size:.82rem;
  font-weight:700;
  box-shadow: inset 0 -1px 0 rgba(0,0,0,.08);
}
.tags{display:flex;gap:8px;flex-wrap:wrap;margin-top:6px}
.tag{padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:var(--panel);color:var(--text);font-size:.9rem}
.note{color:var(--muted)}

/* Quick presets */
.presets{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0 6px}
.chip{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:var(--panel);font-weight:700;color:var(--green);cursor:pointer}
.chip.action:hover{background:color-mix(in srgb, var(--green) 4%, white 96%)}

/* SAFE badge highlight when filters active */
.safe-tag{display:inline-block;margin-left:8px;padding:2px 8px;border-radius:999px;background:color-mix(in srgb, var(--green) 12%, white);border:1px solid color-mix(in srgb, var(--green) 35%, var(--border));color:var(--green);font-weight:700;font-size:.8rem}

/* Bottom-sheet */
.bottom-sheet{position:fixed;left:50%;transform:translateX(-50%);bottom:calc(12px + env(safe-area-inset-bottom) + var(--toolbar,0px));z-index:2147483647;border-radius:16px;background:var(--panel);border:1px solid var(--border);box-shadow:0 18px 40px rgba(14,59,44,.15);transition:max-height .28s ease, transform .28s ease;max-height:60px;overflow:hidden;width:min(92vw,560px)}
.bottom-sheet .sheet-body{display:none}
.bottom-sheet.expanded{max-height:min(86vh,720px)}
.bottom-sheet.expanded .sheet-body{display:block}
@media (min-width:768px){.bottom-sheet{width:min(92vw,760px)}}
@media (min-width:1200px){.bottom-sheet{width:min(900px,70vw)}}
.handle{display:flex;align-items:center;justify-content:center;gap:10px;height:56px;width:100%;border:none;background:transparent;color:var(--green);font-weight:800;letter-spacing:.02em;-webkit-tap-highlight-color:transparent}
.handle-text{color:var(--green)}
.chev{display:inline-block;width:16px;height:16px;border-right:2px solid var(--brand);border-bottom:2px solid var(--brand);transform:rotate(315deg);transition:transform .22s ease;margin-top:2px}
.bottom-sheet.expanded .chev{transform:rotate(135deg)}
.ms-menu{background:var(--panel);border:1px solid var(--border);border-radius:14px;box-shadow:0 10px 30px rgba(14,59,44,.08);padding:10px;max-height:320px;overflow:auto}
.ms-list{display:grid;gap:8px}
.ms-item{display:flex;align-items:center;gap:10px;padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:var(--panel)}
.ms-item input{width:18px;height:18px;accent-color:var(--brand)}
.ms-item .code{font-weight:800;width:2.6ch;text-align:center;color:var(--green)}
.ms-item .name{color:var(--muted)}
.modes{display:flex;gap:10px;flex-wrap:wrap;margin:6px 0 12px}
.chip input{width:16px;height:16px;accent-color:var(--brand)}

/* Keep content clear of dock */
@media (max-width:1199px){body{padding-bottom:160px}}

/* FAB to top */
.fab{position:fixed;right:16px;bottom:calc(88px + env(safe-area-inset-bottom));border:none;border-radius:999px;padding:12px 14px;background:var(--green);color:#fff;font-weight:800;box-shadow:0 10px 26px rgba(14,59,44,.25);cursor:pointer;opacity:.9}
.fab:hover{opacity:1}

/* Footer */
.footer{border-top:1px solid var(--border);padding:16px 0;color:var(--muted);text-align:center}



/* === Modern theme variables and dark-mode contrast === */
:root{
  --brand:#C5A163; --brand-dark:#A88849;
  --green:#0E3B2C; --green-2:#1E5A46;
  --bg:#F9F7EF;
  --panel:#FFFFFF;
  --border:#E5DFD3;
  --text:#0B0F14;
  --muted:#4B5563;
  --toolbar:0px;
}

body{ background: var(--bg); color: var(--fg); }

.card, .dish-card{
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  box-shadow: 0 1px 2px rgba(0,0,0,.03);
}

/* Center header logo */
header, .header, .topbar{
  display: flex;
  align-items: center;
  justify-content: center;
  gap: .75rem;
}

.brand, .logo, .site-brand{
  display:flex;
  align-items:center;
  justify-content:center;
}

.brand img, .logo img, .site-brand img{
  max-height: 44px;
  height: auto;
}

/* Chips / preset buttons */
.preset-bar{
  display:flex;
  flex-wrap: wrap;
  gap:.5rem;
  margin: .5rem 0 1rem;
}
.preset-chip{
  display:inline-flex;
  align-items:center;
  padding:.5rem .75rem;
  border-radius:999px;
  border:1px solid var(--border);
  background: #f2f3f5;
  font-size:.9rem;
  cursor:pointer;
  user-select:none;
}
.preset-chip:active{ transform: translateY(1px); }

@media (prefers-color-scheme: dark){
  :root{
  --brand:#C5A163; --brand-dark:#A88849;
  --green:#0E3B2C; --green-2:#1E5A46;
  --bg:#F9F7EF;
  --panel:#FFFFFF;
  --border:#E5DFD3;
  --text:#0B0F14;
  --muted:#4B5563;
  --toolbar:0px;
}
  .preset-chip{
    background: rgba(255,255,255,.06);
    border-color: var(--border);
  }
  input, select, textarea{
    background: #0f1113;
    color: var(--fg);
    border-color: var(--border);
  }
}


/* --- Header layout adjustments --- */
header, .header, .topbar{
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
}

.header-left{
  justify-self: start;
  display:flex;
  align-items:center;
  gap:.5rem;
}

.brand, .logo, .site-brand{
  justify-self: center;
}

.header-right{
  justify-self: end;
}


/* --- Header corrected grid layout --- */
header, .header, .topbar{
  display: grid !important;
  grid-template-columns: auto 1fr auto;
  align-items: center;
}

.header-left{
  grid-column: 1;
  justify-self: start;
  display:flex;
  gap:.5rem;
  align-items:center;
}

.brand, .logo, .site-brand{
  grid-column: 2;
  justify-self: center;
}

.header-right{
  grid-column: 3;
  justify-self: end;
}

/* High-contrast buttons and inputs */
.btn.primary{
  background: linear-gradient(180deg, var(--brand), var(--brand-dark));
  color: #0b0d12;
  border: 1px solid color-mix(in srgb, var(--brand-dark) 40%, black 60%);
}
html[data-theme="dark"] .btn.primary{
  color: #0b0d12;
}
.btn.ghost{
  background: transparent;
  color: var(--text);
  border:1px solid var(--border);
}
.card, .dish-card{ background: var(--panel); border:1px solid var(--border); }
.tag{ background: var(--panel); color: var(--text); }
.chip{ background: var(--panel); color: var(--green); border:1px solid var(--border); }
html[data-theme="dark"] .chip{ color: #DBEAFE; }

input, select, textarea{
  background: var(--panel);
  color: var(--text);
  border:1px solid var(--border);
}

/* Header grid */
header.nav{
  position: sticky;
  top: 0;
  z-index: 10;
  backdrop-filter: blur(16px) saturate(120%);
  -webkit-backdrop-filter: blur(16px) saturate(120%);
  background: color-mix(in srgb, var(--bg) 70%, transparent);
  border-bottom: 1px solid var(--border);
}
.nav-left{ justify-self:start; display:flex; align-items:center; gap:.5rem; }
.nav-right{ justify-self:end; }
header.nav .brand{ justify-self:center; margin-inline:auto; }

/* Header grid for true-centered logo */
header.nav{
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: .5rem;
}
.nav-left{ grid-column:1; justify-self:start; display:flex; align-items:center; gap:.5rem; }
.nav-right{ grid-column:3; justify-self:end; }
header.nav .brand{ grid-column:2; justify-self:center; }

html[data-theme="dark"] .badge{
  background:#1A2230;
  color:#E6ECF5;
  border-color:#2A384F;
}


/* ===== iOS base & safe areas ===== */
html, body{height:100%; -webkit-text-size-adjust:100%;}
body{min-height:100dvh; min-height:-webkit-fill-available;}
:root{ --gold:#D4AF37; --ivory:#F5F2E9; }

/* ===== Intro overlay ===== */
#app-content.hidden{display:none;}
#intro-screen{
  position:fixed; inset:0; z-index:2147483647;
  display:flex; align-items:center; justify-content:center; text-align:center;
  background: radial-gradient(120% 70% at 50% 0%, #0b0f14 0%, #02140e 45%, #000 100%);
  opacity:1; visibility:visible; transition: opacity .6s ease, visibility .6s ease;
  height:100dvh; height:100svh; min-height:-webkit-fill-available;
  padding-top:env(safe-area-inset-top); padding-bottom:env(safe-area-inset-bottom);
}
#intro-screen.hide{opacity:0; visibility:hidden;}
.intro-title{
  font-family: 'Cinzel','Times New Roman',serif; color:#fff; font-weight:600;
  font-size: clamp(28px,5vw,56px); letter-spacing:.28em; text-transform:uppercase;
  margin:0 0 28px; text-shadow:0 2px 12px rgba(212,175,55,.25);
}
.intro-logo{width:176px; height:176px; border-radius:999px; position:relative; border:0; background:transparent; padding:0;
  cursor:pointer; display:inline-flex; align-items:center; justify-content:center;}
.intro-logo::before{content:""; position:absolute; inset:-24px; border-radius:999px;
  background: radial-gradient(60% 60% at 50% 50%, rgba(212,175,55,.45), rgba(212,175,55,.10) 42%, transparent 70%);
  filter:blur(18px);}
.intro-logo img{width:100%; height:100%; border-radius:999px; object-fit:cover;
  box-shadow:0 12px 32px rgba(0,0,0,.5), inset 0 0 0 1px rgba(255,255,255,.06);}
.intro-logo.fallback{ background: radial-gradient(120% 120% at 30% 20%, #F5E6A8 0%, #D4AF37 55%, #A0771B 100%); }
.intro-logo.fallback::after{
  content:"S"; position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
  font-family:'Cinzel','Times New Roman',serif; font-size:64px; color:#0B0F14; letter-spacing:.02em; border-radius:999px;}
.intro-hint{ margin-top:10px; color:#c8c8c8; font-size:.8rem; letter-spacing:.3em; text-transform:uppercase; }

/* ===== Glass header with centered floating logo ===== */
header.nav.glass{
  position:sticky; top:0; z-index:1000;
  display:grid; grid-template-columns:1fr auto 1fr; align-items:center; gap:.5rem;
  padding:.45rem clamp(.6rem,2vw,1rem);
  background: rgba(255,255,255,.55);
  -webkit-backdrop-filter: blur(14px); backdrop-filter: blur(14px);
  border-bottom:1px solid rgba(0,0,0,.06);
  padding-left:max(.6rem, env(safe-area-inset-left));
  padding-right:max(.6rem, env(safe-area-inset-right));
}
header.nav.glass::after{content:""; position:absolute; left:0; right:0; bottom:-14px; height:14px; pointer-events:none;
  background: linear-gradient(180deg, rgba(0,0,0,.12), transparent);}
header.nav .nav-left{justify-self:start; display:flex; gap:.4rem;}
header.nav .nav-right{justify-self:end; display:flex; gap:.4rem;}

.nav-logo{justify-self:center; align-self:center; display:inline-flex; align-items:center; justify-content:center;
  width:48px; height:48px; border-radius:999px; position:relative; isolation:isolate; transform:translateZ(0);
  animation:logoFloat 5.5s ease-in-out infinite alternate;}
.nav-logo img{width:100%; height:100%; border-radius:999px; object-fit:cover; display:block;
  filter: drop-shadow(0 6px 18px rgba(0,0,0,.25));}
.nav-logo::before{content:""; position:absolute; inset:-10px; border-radius:999px;
  background: radial-gradient(60% 60% at 50% 50%, rgba(212,175,55,.35) 0%, rgba(212,175,55,.10) 45%, transparent 75%);
  filter: blur(7px); z-index:-1; opacity:.95;}
.nav-logo:hover{transform:translateY(-2px);}
.nav-logo:hover img{filter: drop-shadow(0 10px 24px rgba(0,0,0,.30));}
@keyframes logoFloat{ from{transform:translateY(0);} to{transform:translateY(-1.5px);} }

/* ===== Scroll-hide helpers (scoped) ===== */
.show-on-scroll{transform:translateY(0); opacity:1; transition:transform .28s ease, opacity .28s ease;}
.hide-on-scroll{transform:translateY(-100%); opacity:0;}
.show-on-scroll-bottom{transform:translateY(0); opacity:1; transition:transform .28s ease, opacity .28s ease;}
.hide-on-scroll-bottom{transform:translateY(110%); opacity:0;}



/* Intro logo dual-source: element background + <img> */
#intro-screen .intro-logo{
  width: clamp(140px, 16vw, 220px);
  height: clamp(140px, 16vw, 220px);
  border:0; padding:0; cursor:pointer; border-radius:999px;
  display:inline-flex; align-items:center; justify-content:center; position:relative; isolation:isolate;
  background-size: cover; background-position: center; background-repeat: no-repeat;
}
#intro-screen .intro-logo-img{
  width:100%; height:100%; object-fit:cover; border-radius:999px; display:block;
  box-shadow:0 10px 24px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.06);
}
#intro-screen .intro-logo::before{
  content:""; position:absolute; inset:-28px; border-radius:999px; z-index:-1;
  background: radial-gradient(60% 60% at 50% 50%, rgba(212,175,55,.55) 0%, rgba(212,175,55,.12) 45%, transparent 75%);
  filter: blur(22px);
}



/* === Intro Overlay: fullscreen, glow behind logo, iOS-safe === */
#app-content.hidden{ display:none; }
body.intro-active{ overflow:hidden; }
#intro-screen{
  position:fixed; inset:0; z-index:2147483647;
  display:flex; align-items:center; justify-content:center; text-align:center;
  background: radial-gradient(120% 70% at 50% 0%, #0b0f14 0%, #02140e 45%, #000 100%);
  opacity:1; visibility:visible; transition: opacity .5s ease, visibility .5s ease;
  height:100dvh; height:100svh; min-height:-webkit-fill-available;
  padding-top:env(safe-area-inset-top); padding-bottom:env(safe-area-inset-bottom);
}
#intro-screen.hide{ opacity:0; visibility:hidden; }
#intro-screen .intro-content{ position:relative; display:flex; flex-direction:column; align-items:center; gap:10px; }
#intro-screen .intro-logo{
  width: clamp(140px, 16vw, 220px); height: clamp(140px, 16vw, 220px);
  border:0; padding:0; cursor:pointer; border-radius:999px;
  display:inline-flex; align-items:center; justify-content:center; position:relative; isolation:isolate;
  background-size: cover; background-position: center; background-repeat: no-repeat;
  animation: introFloat 4.8s ease-in-out infinite alternate;
}
#intro-screen .intro-logo::before{
  content:""; position:absolute; inset:-28px; border-radius:999px; z-index:-1;
  background: radial-gradient(60% 60% at 50% 50%, rgba(212,175,55,.55) 0%, rgba(212,175,55,.12) 45%, transparent 75%);
  filter: blur(22px);
}
#intro-screen .intro-logo-img{
  width:100%; height:100%; object-fit:cover; border-radius:999px; display:block;
  box-shadow:0 10px 24px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.06);
}
#intro-screen .intro-hint{ color:#dcdcdc; font-size:.78rem; letter-spacing:.28em; text-transform:uppercase; }
@keyframes introFloat{ from{ transform:translateY(0) } to{ transform:translateY(-4px) } }



/* === Header grid: single centered logo === */
header.nav.glass{
  position: sticky; top: 0; z-index: 1000;
  display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; gap: .5rem;
  padding: .45rem clamp(.6rem, 2vw, 1rem);
  background: rgba(255,255,255,.55);
  -webkit-backdrop-filter: blur(14px); backdrop-filter: blur(14px);
  border-bottom: 1px solid rgba(0,0,0,.06);
  padding-left:max(.6rem, env(safe-area-inset-left));
  padding-right:max(.6rem, env(safe-area-inset-right));
}
header.nav .nav-left{justify-self:start; display:flex; gap:.4rem; align-items:center;}
header.nav .nav-right{justify-self:end; display:flex; gap:.4rem; align-items:center;}
.nav-logo{justify-self:center; width:48px; height:48px; border-radius:999px; position:relative; display:inline-flex; align-items:center; justify-content:center; animation:logoFloat 5.5s ease-in-out infinite alternate;}
.nav-logo img{width:100%; height:100%; border-radius:999px; object-fit:cover; display:block; filter: drop-shadow(0 6px 18px rgba(0,0,0,.25));}
@keyframes logoFloat{from{transform:translateY(0)} to{transform:translateY(-1.5px)}}

/* === Sticky allergen bar (fallback) === */
#stickyPanel.allergen-cta{
  position: fixed !important;
  left: 50%; transform: translateX(-50%);
  bottom: max(12px, env(safe-area-inset-bottom) + 12px);
  width: min(980px, calc(100% - 32px));
  z-index: 1200;
  border-radius: 16px;
  background: rgba(255,255,255,.85);
  -webkit-backdrop-filter: blur(12px); backdrop-filter: blur(12px);
  box-shadow: 0 18px 40px rgba(0,0,0,.18);
  padding: 10px;
}
#stickyPanel .cta-btn{
  display:block; width:100%; padding:14px 18px; border-radius:12px; border:1px solid rgba(0,0,0,.08);
  background: linear-gradient(180deg, rgba(250,250,250,0.9), rgba(245,245,245,0.9));
  font-weight:600; letter-spacing:.02em;
}
@media (orientation: landscape) and (min-width:900px){
  #stickyPanel.allergen-cta{ width: min(1100px, calc(100% - 48px)); bottom: max(16px, env(safe-area-inset-bottom) + 16px); }
}
body{ padding-bottom: calc(92px + env(safe-area-inset-bottom)); }
.show-on-scroll-bottom{ transform: translate(-50%, 0); opacity:1; transition: transform .28s ease, opacity .28s ease; }
.hide-on-scroll-bottom{ transform: translate(-50%, 110%); opacity:0; }
html, body{ overflow-x:hidden; }

